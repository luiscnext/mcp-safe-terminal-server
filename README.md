# üîß Safe Terminal MCP Server\n\nA secure **Model Context Protocol (MCP)** server that provides safe terminal command execution for AI assistants like Claude Desktop. Built with TypeScript and comprehensive security controls.\n\n## üõ°Ô∏è Security-First Design\n\nThis server implements **defense-in-depth security** to safely expose terminal capabilities to AI assistants:\n\n- ‚úÖ **Command Whitelisting**: Only pre-approved, safe commands allowed\n- ‚úÖ **Input Sanitization**: Multiple layers of injection prevention\n- ‚úÖ **Resource Limits**: Timeouts, output size limits, rate limiting\n- ‚úÖ **Process Isolation**: Secure execution environment\n- ‚úÖ **Comprehensive Auditing**: Full security event logging\n- ‚úÖ **Directory Restrictions**: Configurable path limitations\n- ‚úÖ **No Destructive Operations**: Read-only and safe commands only\n\n## üöÄ Quick Start\n\n### Prerequisites\n\n- Node.js 18+ \n- TypeScript\n- Git (optional, for git commands)\n- npm (optional, for npm commands)\n\n### Installation\n\n```bash\n# Clone the repository\ngit clone https://github.com/luiscnext/mcp-safe-terminal-server.git\ncd mcp-safe-terminal-server\n\n# Install dependencies\nnpm install\n\n# Build the project\nnpm run build\n\n# Start the server\nnpm start\n```\n\n### Configuration\n\nCopy `.env.example` to `.env` and customize:\n\n```bash\ncp .env.example .env\n# Edit .env with your preferred settings\n```\n\n## üîå Claude Desktop Integration\n\nTo use this server with Claude Desktop, add it to your MCP configuration:\n\n```json\n{\n  \"mcpServers\": {\n    \"safe-terminal\": {\n      \"command\": \"node\",\n      \"args\": [\"/path/to/mcp-safe-terminal-server/dist/index.js\"],\n      \"env\": {\n        \"DEFAULT_WORKING_DIR\": \"/path/to/your/workspace\",\n        \"ALLOWED_DIRECTORIES\": \"/path/to/your/workspace,/tmp/safe\",\n        \"LOG_LEVEL\": \"info\"\n      }\n    }\n  }\n}\n```\n\nSee [docs/CLAUDE_INTEGRATION.md](docs/CLAUDE_INTEGRATION.md) for detailed setup instructions.\n\n## üõ†Ô∏è Available Commands\n\nThe server provides access to carefully vetted commands organized by category:\n\n### System Information (Read-Only)\n- `ls` - List directory contents\n- `pwd` - Show current directory\n- `whoami` - Display current user\n- `date` - Show current date/time\n- `uname` - System information\n- `df` - Disk usage\n- `free` - Memory usage\n- `uptime` - System uptime\n\n### File Operations (Read-Only)\n- `cat` - Display file contents (safe files only)\n- `head` - Show first lines of files\n- `tail` - Show last lines of files\n- `wc` - Count lines/words/characters\n- `find` - Find files (restricted paths)\n\n### Git Operations (Read-Only)\n- `git status` - Repository status\n- `git log` - Commit history\n- `git branch` - List branches\n- `git diff` - Show differences\n- `git show` - Show commit details\n- `git remote` - List remotes\n\n### NPM Operations (Read-Only)\n- `npm list` - List installed packages\n- `npm outdated` - Check for outdated packages\n- `npm view` - View package information\n- `npm config` - View configuration\n\n## üîí Security Features\n\n### Multi-Layer Input Validation\n\n1. **Command Whitelisting**: Only explicitly approved commands\n2. **Argument Sanitization**: Strip dangerous characters and patterns\n3. **Injection Prevention**: Block shell metacharacters and injection patterns\n4. **Path Validation**: Restrict file access to allowed directories\n5. **Length Limits**: Prevent buffer overflow attacks\n\n### Execution Environment\n\n- **Process Isolation**: Commands run in controlled environment\n- **Resource Limits**: CPU time, memory, and output size restrictions\n- **Clean Environment**: Sanitized environment variables\n- **Timeout Protection**: Automatic process termination for long-running commands\n- **No Shell Access**: Direct process spawning without shell interpretation\n\n### Monitoring & Auditing\n\n- **Comprehensive Logging**: All commands and security events logged\n- **Security Event Detection**: Suspicious activity monitoring\n- **Rate Limiting**: Prevent abuse with configurable limits\n- **Audit Trail**: Detailed logs for compliance and incident response\n\n### Blocked Operations\n\nThe following command categories are **explicitly blocked** for security:\n\n- ‚ùå File modification (`rm`, `mv`, `cp`, `chmod`, `chown`)\n- ‚ùå System administration (`sudo`, `su`, `mount`, `fdisk`)\n- ‚ùå Network operations (`wget`, `curl`, `ssh`, `nc`)\n- ‚ùå Process control (`kill`, `killall`, `pkill`)\n- ‚ùå Shell features (`eval`, `exec`, `source`, `bash`)\n- ‚ùå Package installation (`apt`, `yum`, `pip`, `npm install`)\n\n## üìä MCP Tools & Resources\n\n### Tools\n- `execute_safe_command` - Execute whitelisted commands\n- `list_available_commands` - Show available commands\n- `validate_command` - Test command validity\n- `get_server_status` - Server health and statistics\n\n### Resources\n- `command_history` - Recent command execution history\n- `security_log` - Security events and audit trail\n- `server_config` - Current server configuration\n\n### Prompts\n- `explore_project` - Guided project structure exploration\n- `check_git_status` - Git repository status check\n- `project_health_check` - Overall project health assessment\n\n## ‚öôÔ∏è Configuration Options\n\n### Environment Variables\n\n| Variable | Default | Description |\n|----------|---------|-------------|\n| `MAX_REQUESTS_PER_MINUTE` | `30` | Rate limiting |\n| `COMMAND_TIMEOUT_MS` | `10000` | Command timeout |\n| `MAX_OUTPUT_SIZE_BYTES` | `1048576` | Max output size (1MB) |\n| `ALLOWED_DIRECTORIES` | `current dir` | Comma-separated allowed paths |\n| `DEFAULT_WORKING_DIR` | `current dir` | Default execution directory |\n| `LOG_LEVEL` | `info` | Logging level |\n| `ENABLE_GIT_COMMANDS` | `true` | Enable git operations |\n| `ENABLE_NPM_COMMANDS` | `true` | Enable npm operations |\n| `ENABLE_SYSTEM_INFO` | `true` | Enable system info commands |\n\n### CLI Options\n\n```bash\n# Set log level\nnpm start -- --log-level debug\n\n# Change working directory\nnpm start -- --working-dir /path/to/workspace\n\n# Adjust timeout\nnpm start -- --timeout 15000\n\n# Disable features\nnpm start -- --disable-git --disable-npm\n```\n\n## üß™ Testing\n\n```bash\n# Run all tests\nnpm test\n\n# Run security-specific tests\nnpm run test:security\n\n# Run with coverage\nnpm run test:coverage\n\n# Lint code\nnpm run lint\n```\n\n## üìö Documentation\n\n- [Security Guide](docs/SECURITY.md) - Detailed security analysis\n- [Claude Desktop Integration](docs/CLAUDE_INTEGRATION.md) - Setup instructions\n- [API Reference](docs/API.md) - MCP tools and resources\n- [Troubleshooting](docs/TROUBLESHOOTING.md) - Common issues\n\n## üö® Security Considerations\n\n### Before Deployment\n\n1. **Review Allowed Directories**: Ensure paths are appropriate\n2. **Validate Command Whitelist**: Verify only necessary commands enabled\n3. **Configure Rate Limits**: Set appropriate limits for your use case\n4. **Monitor Logs**: Set up log monitoring and alerting\n5. **Regular Updates**: Keep dependencies and security patches current\n\n### Production Recommendations\n\n- Use dedicated user account with minimal privileges\n- Implement log rotation and monitoring\n- Set up network segmentation if needed\n- Regular security audits and penetration testing\n- Monitor for suspicious command patterns\n\n## ü§ù Contributing\n\n1. Fork the repository\n2. Create a feature branch (`git checkout -b feature/amazing-feature`)\n3. Commit changes (`git commit -m 'Add amazing feature'`)\n4. Push to branch (`git push origin feature/amazing-feature`)\n5. Open a Pull Request\n\n### Security Contributions\n\nSecurity improvements are especially welcome! Please:\n\n- Include security test cases\n- Document threat model changes\n- Follow responsible disclosure for vulnerabilities\n\n## üìÑ License\n\nMIT License - see [LICENSE](LICENSE) file for details.\n\n## üôè Acknowledgments\n\n- [Model Context Protocol](https://modelcontextprotocol.io/) by Anthropic\n- [MCP TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk)\n- Security best practices from OWASP and NIST\n\n## üìû Support\n\n- **Issues**: [GitHub Issues](https://github.com/luiscnext/mcp-safe-terminal-server/issues)\n- **Security**: See [SECURITY.md](docs/SECURITY.md) for reporting vulnerabilities\n- **Discussions**: [GitHub Discussions](https://github.com/luiscnext/mcp-safe-terminal-server/discussions)\n\n---\n\n**‚ö†Ô∏è Security Notice**: This server is designed for safe terminal access but should be deployed with appropriate security considerations. Review the security documentation before production use.\n